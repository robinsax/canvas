/*
toolkit.js

Author: Robin Saxifrage
License: Apache 2.0
*/
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(function(){var n,i,r,e,s,h,t,f,o,a,u,d=[].indexOf;f={},o=function(a){return function(){var e,i,t,n,r,s,o;for(e=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i._call.apply(this,t)},o=i=new a;;){for(t=0,n=(s=Object.getOwnPropertyNames(o)).length;t<n;t++)"function"==typeof o[r=s[t]]?e[r]=o[r]:Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r));if(!(o=Object.getPrototypeOf(o)))break}return e}},e=function(){function e(){_classCallCheck(this,e),this.initFunctions=[],this.inspectionFunctions=[],this.modules=[]}return _createClass(e,[{key:"attach",value:function(e){return this.modules.push(e),this}},{key:"onto",value:function(e){var t,n,i,r;for(n=0,i=(r=this.modules).length;n<i;n++)(t=new(0,r[n])(e)).called&&(e[t.called]=t);return this}},{key:"init",value:function(){var e,t,n;for(e=0,t=(n=this.initFunctions).length;e<t;e++)(0,n[e])();return this}},{key:"inspect",value:function(e){var t,n,i;if(0<this.inspectionFunctions.length)for(e=e.extend(e.children()),t=0,n=(i=this.inspectionFunctions).length;t<n;t++)(0,i[t])(e);return this}}]),e}(),a=new e,n=function(){function i(e,t,n){_classCallCheck(this,i),this.tk=e,this.info={method:t,url:n,success:function(){return{}},failure:function(){return{}},query:{},headers:{},body:null}}return _createClass(i,[{key:"success",value:function(e){return this.info.success=e,this}},{key:"failure",value:function(e){return this.info.failure=e,this}},{key:"json",value:function(e){return this.info.headers["Content-Type"]="application/json",this.info.body=this.tk.unbound(e),this}},{key:"data",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"text/plain";return this.info.headers["Content-Type"]=t,this.info.body=e,this}},{key:"header",value:function(e,t){return this.info.headers[e]=t,this}},{key:"query",value:function(e){return this.info.query=e,this}},{key:"send",value:function(){var e,i,t,n,r,s,o,a,u,l=this;if(n=function(e){var t,n,i;switch(i=e.status,n=e.getResponseHeader("Content-Type"),t=e.responseText,n){case"application/json":t=JSON.parse(t)}return l.tk.log("Received "+i+" ("+l.info.method+", "+l.info.url+")"),(i<400?l.info.success:l.info.failure)(t,i)},e=this.info.url,o="",0<(r=Object.keys(this.info.query))&&(e+="?"+function(){var e,t,n;for(n=[],e=0,t=r.length;e<t;e++)i=r[e],n.push(i+"="+encodeURIComponent(this.info.query[i]));return n}.call(this).join("&")),this.info.body)switch(t=this.info.headers["Content-Type"]){case"application/json":o=JSON.stringify(this.info.body);break;default:throw"Unknown outgoing mimetype "+t}for(i in(u=new XMLHttpRequest).onreadystatechange=function(){if(4===this.readyState)return n(this)},u.open(this.info.method,e,!0),s=this.info.headers)a=s[i],u.setRequestHeader(i,a);return u.send(o),this.tk.log("Sent ("+this.info.method+", "+this.info.url+")",this.info.body)}}]),i}(),a.attach(o(function(){function t(e){_classCallCheck(this,t),this.tk=e,this.called="request"}return _createClass(t,[{key:"_call",value:function(e,t){return new n(this,e,t)}}]),t}())),h=function(){var e=function(){function p(e,t){var n,i,r;if(_classCallCheck(this,p),this.parent=t,e instanceof p)this.set=e.set.slice();else if(e instanceof Element||e instanceof Node||e instanceof Window)this.set=[e];else if(e instanceof NodeList||e instanceof Array)for(this.set=[],i=0,r=e.length;i<r;i++)n=e[i],this.set=this.set.concat(p.clean(n));else{if("string"!=typeof e)throw"Illegal selection: "+e;this.set=p.tk.config.root.querySelectorAll(e)}this.length=this.set.length,this.empty=0===this.length}return _createClass(p,null,[{key:"clean",value:function(e){var t,n,i,r;if(e instanceof Node)return[e];for(e instanceof p&&(e=e.set),t=[],i=0,r=e.length;i<r;i++)(n=e[i])instanceof p?t=t.concat(n.set):t.push(n);return t}}]),_createClass(p,[{key:"back",value:function(){if(!this.parent)throw"Illegal back";return this.parent}},{key:"ith",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(e<0||e>this.length)throw"Out of bounds: "+e;return t?new p(this.set[e],this):this.set[e]}},{key:"first",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return this.ith(0,e)}},{key:"reversed",value:function(){var e;return(e=this.set.slice()).reverse(),new p(e,this)}},{key:"reduce",value:function(t){var e;switch(void 0===t?"undefined":_typeof(t)){case"string":e=this.comp(function(e){if(e.is(t))return e});break;case"function":e=this.comp(t);break;default:throw"Illegal reducer"}return new p(e,this)}},{key:"extend",value:function(e){var t;if(e instanceof p)t=e.set;else{if(!(e instanceof Array||e instanceof NodeList))throw"Illegal extension";t=p.clean(e)}return new p(this.set.concat(t,this))}},{key:"parents",value:function(){var i,n,r,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*",o=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if((n=["string","function","boolean"].indexOf(void 0===s?"undefined":_typeof(s)))<0)throw"Illegal condition";return 2===n&&(n=0,s="*",o=!1),i=function(e,t){return 0===n?e.is(s):s(e,t)},r=[],this.iter(function(e,t){var n;for(n=e.first(!1).parentNode;n!==p.tk.config.root&&null!==n;){if(i(tk(n,t))&&r.push(n),!o)return;n=n.parentNode}}),new p(r,this)}},{key:"children",value:function(){var c,h,f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*",d=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if((c=["string","function"].indexOf(void 0===f?"undefined":_typeof(f)))<0)throw"Illegal condition";return h=[],this.iter(function(e,t){var n,i,r,s,o,a,u,l;if((e=e.first(!1)).nodeType!==Node.TEXT_NODE){if(l=[],0===c)if(d)l=e.querySelectorAll(f);else for(r=0,o=(u=e.children).length;r<o;r++)(i=u[r]).matches(f)&&(l=i);else for(new p(n=d?e.querySelectorAll("*"):e.children),s=0,a=n.length;s<a;s++)i=n[s],f(wrap,t)&&(l=i);return h=h.concat(l)}}),new p(h,this)}},{key:"copy",value:function(){var e;return e=this.set[0].cloneNode(!0),new p(e,this)}},{key:"iter",value:function(e){var t,n,i,r;for(t=n=0,i=(r=this.set).length;n<i&&!1!==e(new p(r[t]),t);t=++n);return this}},{key:"comp",value:function(e){var t,n,i,r,s,o;for(s=[],t=n=0,i=(r=this.set).length;n<i;t=++n)void 0!==(o=e(new p(r[t]),t))&&s.push(o);return s}},{key:"is",value:function(e){var t,n,i,r,s,o;for(t=["string","function"].indexOf(void 0===e?"undefined":_typeof(e)),i=r=0,s=(o=this.set).length;r<s;i=++r){if(n=o[i],!(0!==t||n.nodeType!==Node.TEXT_NODE&&n.matches(e)))return!1;if(1===t&&!e(new p(n),i))return!1}return!0}},{key:"classes",value:function(){var e,t,n,i,r,s,o,a,u;for(e=[],n=i=0,s=(u=this.set).length;i<s;n=++i)for(r=0,o=(a=u[n].className.split(/\s+/)).length;r<o;r++)t=a[r],d.call(e,t)<0&&e.push(t);return e}},{key:"value",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f;return t===f?"checkbox"===this.set[0].type?this.set[0].checked:(t=this.set[0].value)?"number"===this.set[0].type?+t:t:null:(this.iter(function(e){return"select"===e.tag().toLowerCase()?e.children("option").attr("selected",function(e){return!!e.attr("value"===t)||null}):e.first(!1).value=t}),this)}},{key:"attr",value:function(n){var e,t,i,r,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f;if("string"==typeof n){if(s===f)return this.set[0].getAttribute(n);for(t=0,i=(r=this.set).length;t<i;t++)e=r[t],null===s?e.removeAttribute(n):e.setAttribute(n,s);return this}if("object"===(void 0===n?"undefined":_typeof(n)))return this.iter(function(e){var t;for(t in n)s=n[t],e.attr(t,s)}),this;throw"Illegal argument: "+n}},{key:"css",value:function(e){var t,n,s=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f;if(t=function(i,r){return i=i.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()}),s.iter(function(e,t){var n;return"number"==typeof(n=p.tk.resolve(r,e,t))&&(n+="px"),e.set[0].style[i]=n})},"string"==typeof e){if(i===f)return window.getComputedStyle(this.set[0]).getPropertyValue(e);t(e,i)}else{if("object"!==(void 0===e?"undefined":_typeof(e)))throw"Illegal argument";for(n in e)t(n,i=e[n])}return this}},{key:"on",value:function(e){var t,n,i,r,s,o=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f;if(t=function(r,s){return o.iter(function(t,n){var e,i;return(e=t.first(!1)).__listeners__||(e.__listeners__=[]),"function"==typeof r&&(r=r(t,n)),i={event:r,callback:function(e){return s(t,e,n)}},e.__listeners__.push(i),e.addEventListener(i.event,i.callback)})},"string"==typeof e)if(a===f){if(null==pure.__listeners__)return[];for(n=0,i=(s=pure.__listeners__).length;n<i;n++)return s[n].callback}else t(e,a);else{if("object"!==(void 0===e?"undefined":_typeof(e)))throw"Illegal argument";for(r in e)t(r,e[r])}return this}},{key:"off",value:function(i){var e,t,n,r,s,o,a,u;for(t=0,r=(a=this.set).length;t<r;t++){for(e=a[t],n=0,s=(o=null!=e.__listeners__||[]).length;n<s;n++)(u=o[n]).event===i&&e.removeEventListener(u.event,u.callback);e.__listeners__=function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)(u=o[e]).event!==i&&n.push(u);return n}()}return this}},{key:"classify",value:function(e){var c,t,n,i=this,r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:f;if(c=function(a,u,l){return"toggle"===u&&(u=function(e,t){return d.call(e.classes(),a)<0}),i.iter(function(e,t){var n,i,r,s,o;if("function"==typeof(i=u)&&(i=i(e,t)),n=e.classes(),r=0<=d.call(n,a),i&&!r?n.push(a):!i&&r&&(s=n.indexOf(a),n.splice(s,1)),e.set[0].className=n.join(" ").trim(),l!==f)return"function"==typeof(o=l)&&(o=o(e,t)),p.tk.timeout(o,function(e){return c(a,!i,f)})})},"string"==typeof e)c(e,r,s);else for(n in e)t=e[n],c(n,t,f);return this}},{key:"remove",value:function(){var e,t,n,i;for(t=0,n=(i=this.set).length;t<n;t++)null!==(e=i[t]).parentNode&&e.parentNode.removeChild(e);return this}},{key:"append",value:function(e){var t,n,i,r;for((e=new p(e,this)).remove(),this.first().parents("body").empty||p.tk.guts.inspect(e),n=0,i=(r=e.set).length;n<i;n++)t=r[n],this.set[0].appendChild(t);return e}},{key:"prepend",value:function(e){var t,n,i;for((e=new p(e,this)).remove(),this.first().parents("body").empty||p.tk.guts.inspect(e),n=(i=e.set).length-1;0<=n;n+=-1)t=i[n],this.set[0].prepend(t);return e}},{key:"replace",value:function(e){var t;return this.first().parents("body").empty||((t=e)instanceof p||(t=new p(t,this)),p.tk.guts.inspect(t)),e instanceof p&&(e=e.first(!1)),this.set[0].parentNode.replaceChild(e,this.set[0]),new p(e,this.parent)}},{key:"tag",value:function(){return this.set[0].tagName}},{key:"next",value:function(){var e,t,n,i,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f;if(r===f)return this.empty?new p([]):new p(this.set[0].nextSibling,this);for(!r instanceof p&&(r=tk(r)),t=0,n=(i=r.set).length;t<n;t++)e=i[t],this.set[0].parentNode.insertBefore(e,this.set[0].nextSibling);return r.parent=this,r}},{key:"prev",value:function(){var e,t,n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f;if(i===f)return this.empty?new p([]):new p(this.set[0].previousSibling,this);for(!i instanceof p&&(i=tk(i)),t=(n=i.set).length-1;0<=t;t+=-1)e=n[t],this.set[0].parentNode.insertBefore(e,this.set[0]);return i.parent=this,i}},{key:"html",value:function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f;return n===f?this.set[0].innerHTML:(this.iter(function(e,t){return e.set[0].innerHTML=p.tk.resolve(n,e,t)}),this)}},{key:"text",value:function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f;return n===f?this.set[0].textContent:(this.iter(function(e,t){return e.set[0].textContent=p.tk.resolve(n,e,t)}),this)}},{key:"select",value:function(){return this.set[0].select(),this}},{key:"offset",value:function(){var e,t,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0];for(t={x:0,y:0},e=this.set[0];e&&(t.x+=e.offsetLeft,t.y+=e.offsetTop,!n);)e=e.offsetParent;return t}},{key:"size",value:function(){var e,t,n,i,r=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return n={width:(e=(t=this.set[0]).getBoundingClientRect()).width,height:e.height},r&&(i=window.getComputedStyle(t,null),n.width+=i.getPropertyValue("margin-left"),n.width+=i.getPropertyValue("margin-right"),n.height+=i.getPropertyValue("margin-top"),n.height+=i.getPropertyValue("margin-bottom"),"border-box"===i.getPropertyValue("box-sizing")&&(n.width+=i.getPropertyValue("padding-left"),n.width+=i.getPropertyValue("padding-right"),n.height+=i.getPropertyValue("padding-top"),n.height+=i.getPropertyValue("padding-bottom"))),n}}]),p}();return e.tk=null,e}.call(this),a.attach(function e(t){_classCallCheck(this,e),(t.ToolkitSelection=h).tk=t}),s=function(){function i(e,t){var n;_classCallCheck(this,i),this.object=e,this.property=t,this.object.__listeners__||(this.object.__listeners__={}),this.object.__listeners__[this.property]||(this.object.__listeners__[this.property]=[],n=this._descriptor(this.object[this.property],this.object.__listeners__[this.property]),Object.defineProperty(this.object,this.property,n)),this.object.__listeners__[this.property].push(this),this._changed=function(){},this._accessed=function(){}}return _createClass(i,[{key:"_descriptor",value:function(e,i){var r;return r=e,{get:function(){var e,t;for(e=0,t=i.length;e<t;e++)i[e]._accessed(r);return r},set:function(e){var t,n;if(r===e)return r;for(r=e,t=0,n=i.length;t<n;t++)i[t]._changed(e);return r}}}},{key:"changed",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return this._changed=e,t&&e(this.object[this.property]),this}},{key:"accessed",value:function(e){return this._accessed=e,this}},{key:"remove",value:function(){var e;return e=this.object.__listeners__[this.property].indexOf(this),this.object.__listeners__[this.property].splice(e,1),this}}]),i}(),r=function(){function t(e){_classCallCheck(this,t),this.array=e,this.array.__listeners__||this._mixinListeners(),this.array.__listeners__.push(this),this._added=function(){},this._removed=function(){},this._accessed=function(){}}return _createClass(t,[{key:"_mixinListeners",value:function(){var r,c,y,g,_,k=this;return g=this.array.__listeners__=[],_=function(){var e,t,n,i,r;for(r=[],t=n=0,i=k.array.length;0<=i?n<i:i<n;t=0<=i?++n:--n)e=k._indexDescriptor(k.array[t],t,g),r.push(Object.defineProperty(k.array,t+"",e));return r},c=this.array.push,this.array.push=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,r,s,o,a,u,l;for(l=k.array.length,c.apply(k.array,t),_(),i=s=0,a=t.length;s<a;i=++s)for(r=t[i],o=0,u=g.length;o<u;o++)g[o]._added(r,l+i);return k.array.length},r=this.array.pop,this.array.pop=function(){var e,t,n,i;for(i=k.array[e=k.array.length-1],r.apply(k.array),_(),t=0,n=g.length;t<n;t++)g[t]._removed(i,e);return i},y=this.array.splice,this.array.splice=function(r,s){for(var e=arguments.length,t=Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];var o,i,a,u,l,c,h,f,d,p,v;for(p=function(){var e,t,n,i;for(i=[],o=e=t=r,n=r+s;t<=n?e<n:n<e;o=t<=n?++e:--e)i.push(this.array[o]);return i}.call(k),v=y.apply(k.array,[r,s].concat(t)),_(),o=i=0,f=s;0<=f?i<f:f<i;o=0<=f?++i:--i)for(a=0,l=g.length;a<l;a++)g[a]._removed(p[o],r+o);for(o=u=0,d=t.length;0<=d?u<d:d<u;o=0<=d?++u:--u)for(h=0,c=g.length;h<c;h++)g[h]._added(k.array[r+o],o);return v}}},{key:"_indexDescriptor",value:function(e,s,o){var a;return a=e,{get:function(){var i;return function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)i=o[e],n.push(i._accessed(a))}(),a},set:function(e){var t,n,i,r;if(a===e)return a;for(a=e,t=0,i=o.length;t<i;t++)o[t]._removed(a,s);for(n=0,r=o.length;n<r;n++)o[n]._added(e,s);return a},configurable:!0}}},{key:"added",value:function(e){var t,n,i,r;for(this._added=e,t=n=0,i=(r=this.array).length;n<i;t=++n)e(r[t],t);return this}},{key:"removed",value:function(e){return this._removed=e,this}},{key:"accessed",value:function(e){return this._accessed=e,this}}]),t}(),a.attach(o(function(){function e(){_classCallCheck(this,e),this.called="listener"}return _createClass(e,[{key:"_call",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f;if(e instanceof Array)return new r(e);if("object"===(void 0===e?"undefined":_typeof(e)))return new s(e,t);throw"Invalid parameter"}}]),e}())),t=function(){function n(e,t){_classCallCheck(this,n),this.tk=e,this.definition=t,this._data=null}return _createClass(n,[{key:"data",value:function(){return this._data=arguments,this}},{key:"_safeAppend",value:function(e,t){var n,i,r,s;if(t instanceof Array){for(s=[],i=0,r=t.length;i<r;i++)n=t[i],s.push(e.appendChild(n));return s}return e.appendChild(t)}},{key:"_realize",value:function(i){var e,r,t,n,s,o,a,u,l;if(!i)return document.createTextNode("");if("string"==typeof i||"number"==typeof i)u=document.createTextNode(i);else if("function"==typeof i)u=this._realize(i());else if(i instanceof Array)u=function(){var e,t,n;for(n=[],e=0,t=i.length;e<t;e++)r=i[e],n.push(this._realize(r));return n}.call(this);else{for(s in u=document.createElement(i.tag),o=i.attributes)l=o[s],u.setAttribute(s,l);for(t=0,n=(a=i.children).length;t<n;t++)e=a[t],this._safeAppend(u,this._realize(e))}return u}},{key:"render",value:function(){return this.tk(this._realize(this.definition.apply(null,this._data)))}}]),n}(),a.attach(o(function(){function e(){_classCallCheck(this,e),this.called="template"}return _createClass(e,[{key:"_call",value:function(e){return new t(this,e)}},{key:"tag",value:function(e,t){for(var n=arguments.length,i=Array(2<n?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return{tag:e,attributes:t||{},children:i,_virtual:!0}}}]),e}())),i=o(function(){function t(){var e;_classCallCheck(this,t),this.initialized=!1,e=!0,Object.defineProperty(this,"here",{get:function(){if(!e)return console.log("here"),"here";e=!1}})}return _createClass(t,[{key:"_call",value:function(e){return new h(e)}},{key:"_finalize",value:function(e){var t,n,i=this;this.config={root:null!=(t=e.root)?t:"undefined"!=typeof document&&null!==document?document:null,debug:null!=(n=e.debug)&&n},this.guts=a.onto(this),/complete|loaded|interactive/.test("undefined"!=typeof document&&null!==document?document.readyState:void 0)?(this.initialized=!0,this.guts.init()):"undefined"!=typeof window&&null!==window&&window.addEventListener("DOMContentLoaded",function(){return i.initialized=!0,i.guts.init()})}},{key:"init",value:function(e){return this.initialized&&e(),this.guts.initFunctions.push(e),this}},{key:"inspection",value:function(e){return this.guts.inspectionFunctions.push(e),this}},{key:"log",value:function(){for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return(null!=(e=this.config)?e.debug:void 0)&&console.log.apply(null,n),n[0]}},{key:"warn",value:function(){for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return(null!=(e=this.config)?e.debug:void 0)&&console.warn.apply(null,n),n[0]}},{key:"resolve",value:function(e){if("function"!=typeof e)return e;for(var t=arguments.length,n=Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.apply(null,n)}},{key:"time",value:function(){return(new Date).getTime()}},{key:"range",value:function(e){var t,n,i,r,s,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;for(i=0,a&&(i=e,e=a),o=[],t=n=r=i,s=e;r<=s?n<s:s<n;t=r<=s?++n:--n)o.push(t);return o}},{key:"iter",value:function(e,t){var n,i,r,s;if(e instanceof Array)for(n=i=0,r=e.length;i<r&&!1!==t(e[n],n);n=++i);else{if("object"!==(void 0===e?"undefined":_typeof(e)))throw"Not iterable: "+e;for(s in e)if(!1===t(s,e[s]))break}}},{key:"comp",value:function(e,t){var n,i,r,s,o;for(s=[],n=i=0,r=e.length;i<r;n=++i)null!=(o=t(e[n],n))&&s.push(o);return s}},{key:"compr",value:function(e,t){return console.warn("compr() is deprecated! Use comp() instead."),this.comp(e,t)}},{key:"timeout",value:function(e,t){return setTimeout(t,e)}},{key:"tag",value:function(e){var t,n,i,r,s,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(r in n=document.createElement(e),a)o=a[r],n.setAttribute(r,o);for(var u=arguments.length,l=Array(2<u?u-2:0),c=2;c<u;c++)l[c-2]=arguments[c];for(i=0,s=l.length;i<s;i++)"string"==typeof(t=l[i])?n.appendChild(document.createTextNode(t)):n.appendChild(this.tag(t));return new h(n)}}]),t}()),u={create:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(e=new i)._finalize(t),e}},"undefined"!=typeof window&&null!==window?window.toolkit=u:module.exports=u}).call(void 0);